---
description: 修复失败的测试用例
argument-hint: [failed-test-file]
---

<failed-test-file>$1</failed-test-file>

我在执行单元测试时，发现测试文件 `<failed-test-file>` 中有失败的测试用例。请帮我完成以下任务：

1. **执行测试并分析失败原因**：

   - 运行指定的测试文件，获取详细的错误信息和堆栈跟踪
   - 分析每个失败测试用例的具体失败原因（断言失败、Mock 配置问题、测试数据问题等）
   - 检查相关源代码是否有变更导致测试逻辑不再适用

2. **制定修复方案**：

   - 根据失败原因确定是需要修复测试代码还是源代码
   - 如果是测试代码问题，更新测试逻辑、断言或 Mock 配置
   - 如果是源代码问题，修复源代码逻辑错误
   - 确保修复不会影响其他测试用例

3. **实施修复并验证**：

   - 按照修复方案逐一实施修复
   - 每次修复后立即运行测试验证效果
   - 确保所有原失败的测试用例现在都能通过
   - 运行完整测试套件确保没有引入新的失败

4. **代码质量检查**：
   - 执行 `pnpm lint` 进行代码规范检查
   - 执行 `pnpm type-check` 进行类型检查
   - 修复任何代码规范或类型问题

请提供详细的失败原因分析和修复过程说明。
