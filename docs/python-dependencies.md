# Python ä¾èµ–ç®¡ç†æŒ‡å—

xiaozhi-client Docker å®¹å™¨æ”¯æŒåŠ¨æ€ Python ä¾èµ–ç®¡ç†ï¼Œè®©ä½ å¯ä»¥è½»æ¾æ·»åŠ å’Œç®¡ç† Python åŒ…ï¼Œç‰¹åˆ«é€‚ç”¨äº MCP (Model Context Protocol) æœåŠ¡å™¨å¼€å‘ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»ºè‡ªå®šä¹‰ä¾èµ–æ–‡ä»¶

åœ¨ä½ çš„æŒ‚è½½ç›®å½•ï¼ˆé€šå¸¸æ˜¯ `~/xiaozhi-client/`ï¼‰ä¸­åˆ›å»º `requirements.txt` æ–‡ä»¶ï¼š

```bash
# åœ¨ä¸»æœºä¸Šåˆ›å»ºæ–‡ä»¶
echo "mcp-proxy>=0.8.2" > ~/xiaozhi-client/requirements.txt
```

### 2. é‡å¯å®¹å™¨

```bash
docker restart xiaozhi-client
```

å®¹å™¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶å®‰è£…æ–°çš„ä¾èµ–åŒ…ã€‚

## ğŸ“‹ å·¥ä½œåŸç†

### ä¾èµ–å®‰è£…ä¼˜å…ˆçº§

1. **ç”¨æˆ·è‡ªå®šä¹‰** (`~/xiaozhi-client/requirements.txt`) - æœ€é«˜ä¼˜å…ˆçº§
2. **é»˜è®¤æ¨¡æ¿** (`templates/docker/requirements.txt`) - ä»…åœ¨ç”¨æˆ·æœªè‡ªå®šä¹‰æ—¶ä½¿ç”¨

### å®‰è£…æµç¨‹

å®¹å™¨å¯åŠ¨æ—¶ä¼šæŒ‰ä»¥ä¸‹é¡ºåºæ‰§è¡Œï¼š

1. æ£€æŸ¥ `/workspaces/requirements.txt`ï¼ˆç”¨æˆ·è‡ªå®šä¹‰æ–‡ä»¶ï¼‰
2. å¦‚æœå­˜åœ¨ä¸”åŒ…å«æœ‰æ•ˆå†…å®¹ï¼Œå®‰è£…ç”¨æˆ·ä¾èµ–
3. å¦‚æœä¸å­˜åœ¨ï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦å®‰è£…é»˜è®¤ä¾èµ–
4. æ‰€æœ‰ä¾èµ–éƒ½å®‰è£…åœ¨ Python è™šæ‹Ÿç¯å¢ƒä¸­ï¼ˆ`/opt/venv`ï¼‰

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šæ·»åŠ  MCP ç›¸å…³åŒ…

```bash
# ~/xiaozhi-client/requirements.txt
mcp-proxy>=0.8.2
mcp-server-git>=0.1.0
```

### ç¤ºä¾‹ 2ï¼šæ·»åŠ æ•°æ®ç§‘å­¦åŒ…

```bash
# ~/xiaozhi-client/requirements.txt
numpy>=1.24.0
pandas>=2.0.0
matplotlib>=3.7.0
```

### ç¤ºä¾‹ 3ï¼šæ·»åŠ  Web å¼€å‘åŒ…

```bash
# ~/xiaozhi-client/requirements.txt
fastapi>=0.104.0
uvicorn>=0.24.0
sqlalchemy>=2.0.0
```

### ç¤ºä¾‹ 4ï¼šå®Œæ•´çš„ MCP æœåŠ¡å™¨ä¾èµ–

```bash
# ~/xiaozhi-client/requirements.txt
# MCP æ ¸å¿ƒ
mcp>=1.13.0
fastmcp>=2.11.0

# ç½‘ç»œé€šä¿¡
httpx>=0.27.0
websockets>=12.0

# æ•°æ®å¤„ç†
pydantic>=2.11.0
python-dotenv>=1.0.0

# è‡ªå®šä¹‰åŒ…
mcp-proxy>=0.8.2
openai>=1.0.0
```

## ğŸ”§ é«˜çº§ç”¨æ³•

### ç‰ˆæœ¬å›ºå®š

```bash
# å›ºå®šç‰¹å®šç‰ˆæœ¬
mcp==1.13.0
fastmcp==2.11.0

# ç‰ˆæœ¬èŒƒå›´
httpx>=0.27.0,<1.0.0
pydantic>=2.11.0,<3.0.0
```

### ä» Git å®‰è£…

```bash
# ä» GitHub å®‰è£…å¼€å‘ç‰ˆæœ¬
git+https://github.com/user/repo.git
git+https://github.com/user/repo.git@branch_name
```

### å¯é€‰ä¾èµ–

```bash
# å®‰è£…åŒ…çš„å¯é€‰ä¾èµ–
fastapi[all]>=0.104.0
httpx[http2]>=0.27.0
```

## ğŸ› æ•…éšœæ’é™¤

### æŸ¥çœ‹å®‰è£…æ—¥å¿—

å®¹å™¨å¯åŠ¨æ—¶ä¼šæ˜¾ç¤ºè¯¦ç»†çš„å®‰è£…æ—¥å¿—ï¼š

```bash
docker logs xiaozhi-client
```

### å¸¸è§é—®é¢˜

#### 1. ä¾èµ–å®‰è£…å¤±è´¥

**ç—‡çŠ¶**ï¼šå®¹å™¨å¯åŠ¨æ—¶æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯
**è§£å†³**ï¼š
- æ£€æŸ¥åŒ…åæ‹¼å†™æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ç‰ˆæœ¬å·æ˜¯å¦å­˜åœ¨
- æŸ¥çœ‹å®Œæ•´é”™è¯¯æ—¥å¿—

#### 2. åŒ…ç‰ˆæœ¬å†²çª

**ç—‡çŠ¶**ï¼šå®‰è£…è¿‡ç¨‹ä¸­å‡ºç°ä¾èµ–å†²çª
**è§£å†³**ï¼š
- ä½¿ç”¨å…¼å®¹çš„ç‰ˆæœ¬èŒƒå›´
- ç§»é™¤å†²çªçš„åŒ…
- ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»

#### 3. ç½‘ç»œè¿æ¥é—®é¢˜

**ç—‡çŠ¶**ï¼šä¸‹è½½åŒ…æ—¶è¶…æ—¶
**è§£å†³**ï¼š
- å®¹å™¨å·²é…ç½®æ¸…åå¤§å­¦ PyPI é•œåƒæº
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- é‡è¯•å®‰è£…

### æ‰‹åŠ¨å®‰è£…åŒ…

å¦‚æœéœ€è¦åœ¨è¿è¡Œä¸­çš„å®¹å™¨å†…æ‰‹åŠ¨å®‰è£…åŒ…ï¼š

```bash
# è¿›å…¥å®¹å™¨
docker exec -it xiaozhi-client bash

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…
source /opt/venv/bin/activate
pip install package_name
```

## ğŸ“š é»˜è®¤é¢„è£…åŒ…

å®¹å™¨é»˜è®¤åŒ…å«ä»¥ä¸‹ MCP å¼€å‘å¸¸ç”¨åŒ…ï¼š

- `mcp` - å®˜æ–¹ MCP Python SDK
- `fastmcp` - é«˜çº§ MCP æ¡†æ¶
- `httpx` - ç°ä»£ HTTP å®¢æˆ·ç«¯
- `websockets` - WebSocket æ”¯æŒ
- `pydantic` - æ•°æ®éªŒè¯
- `python-dotenv` - ç¯å¢ƒå˜é‡ç®¡ç†
- `aiofiles` - å¼‚æ­¥æ–‡ä»¶æ“ä½œ

å®Œæ•´åˆ—è¡¨è¯·æŸ¥çœ‹ `templates/docker/requirements.txt`ã€‚

## ğŸ”„ æ›´æ–°ä¾èµ–

### æ›´æ–°å•ä¸ªåŒ…

```bash
# ä¿®æ”¹ requirements.txt ä¸­çš„ç‰ˆæœ¬å·
mcp>=1.14.0  # ä» 1.13.0 æ›´æ–°åˆ° 1.14.0

# é‡å¯å®¹å™¨
docker restart xiaozhi-client
```

### æ‰¹é‡æ›´æ–°

```bash
# åœ¨å®¹å™¨å†…æ‰‹åŠ¨æ›´æ–°
docker exec -it xiaozhi-client bash
source /opt/venv/bin/activate
pip install --upgrade -r requirements.txt
```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **ç‰ˆæœ¬ç®¡ç†**ï¼šä½¿ç”¨ç‰ˆæœ¬èŒƒå›´è€Œä¸æ˜¯å›ºå®šç‰ˆæœ¬ï¼Œç¡®ä¿å…¼å®¹æ€§
2. **ä¾èµ–åˆ†ç»„**ï¼šåœ¨ requirements.txt ä¸­ä½¿ç”¨æ³¨é‡Šåˆ†ç»„ç›¸å…³ä¾èµ–
3. **æµ‹è¯•éªŒè¯**ï¼šæ·»åŠ æ–°ä¾èµ–åæµ‹è¯• MCP æœåŠ¡å™¨åŠŸèƒ½
4. **å¤‡ä»½é…ç½®**ï¼šå®šæœŸå¤‡ä»½ requirements.txt æ–‡ä»¶
5. **æœ€å°åŒ–åŸåˆ™**ï¼šåªå®‰è£…å¿…éœ€çš„åŒ…ï¼Œé¿å…è‡ƒè‚¿

## ğŸ”— ç›¸å…³é“¾æ¥

- [MCP å®˜æ–¹æ–‡æ¡£](https://modelcontextprotocol.io/)
- [FastMCP æ–‡æ¡£](https://gofastmcp.com/)
- [Python åŒ…ç´¢å¼• (PyPI)](https://pypi.org/)
- [pip ç”¨æˆ·æŒ‡å—](https://pip.pypa.io/en/stable/user_guide/)
